# Cheerfully Client

This client service provides an API for interfacing with Cheerfully services. Cheerfully makes voice-over easy.

To use the API, you will need to specify a root `./env-cheerfully.json` file with the following format:

```javascript
{
    "server": "http://server:port",
    "accessToken": "accessTokenToUseCheerfullyService"
}
```

## Services

All services can be specified in `cheerfully.json` as described in the following sections. Services can be run as scripts specified in `package.json` as:

```javascript
{
    "scripts": {
        "speech": "cheer -service elevenlabs",
        "lipsync": "cheer -service rhubarb",
        "captions": "cheer -service transcription"
    }
}
```

Alternatively, services can be run from Node by including the Cheerfully Client as shown:

```javascript
const
    cheerfully = require('cheerfully-client');

cheerfully({
    service: 'polly'
});
```

### ElevenLabs

This text-to-voice service requires a script as input and will download audio VO generated by ElevenLabs. You can set ElevenLabs settings in `cheerfully.json` like so:

```javascript
{
    "elevenlabs": [{
        "script": "./example/script.json",
        "output": "./example/vo/en/",
        "model": "eleven_multilingual_v1",
        "voice": "Gigi"
    }]
}
```

Specifying the `model` is optional: if unspecified, Cheerfully will pick a good option for the selected `voice`.

You may include your ElevenLabs API Key directly in the ElevenLabs spec above as `apiKey`, or set your API Key separately in `env-cheerfully.json`:

```javascript
{
    "elevenLabsApiKey": "elevenlabsapikeyforyouraccount"
}
```

### Polly

This text-to-voice service requires a script as input and will download audio VO generated by Amazon Polly. You can set Polly settings in `cheerfully.json` like so:

```javascript
{
    "polly": [{
        "script": "./example/script.json",
        "output": "./example/vo/en/",
        "language": "en-US",
        "voice": "Ivy"
    }]
}
```

### Rhubarb

This audio-to-lip-flap service requires audio as input and will download a mouth cues JSON file delineating mouth shapes for particular timestamps using Rhubarb Lip-Sync. You can set Rhubarb settings in `cheerfully.json` like so:

```javascript
{
    "rhubarb": [{
        "options" {
            "exportFormat": "json"
        },
        "src": "./example/vo/en/",
        "output": "./example/lipsync/en/"
    }]
}
```

Export formats include those supported by Rhubarb as well as "mp3" which will embed lipsync timings into the MP3's id3 meta data.

### Transcription

This audio-to-captions service requires audio as input and will download a captions JSON file delineating captions with timestamps using Amazon Transcription. You can set Transcription settings in `cheerfully.json` like so:

```javascript
{
    "transcription": [{
        "format": "sami",
        "language": "en-US",
        "limit": 40,
        "script": "./example/script.json",
        "src": "./example/vo/en/",
        "nowrap": [],
        "output": "./example/captions/en/"
    }]
}
```

Transcription supports the following formats:

* JSON
* MP3 (Embedded in source MP3 as a SYLT ID3 tag labeled "captions".)
* SAMI / SMI
* SRT
* VTT

Specify `limit` to set the maximum number of characters for a single caption line. The default is `40`.

If your scripts include any phrases that should remain unbroken by the captioning process, add them to the `nowrap` list. For example: `"nowrap": ["Makefully Studios"]`.

## Example

Find an example script in the `./examples/` folder. You can run either `npm run test-elevenlabs` or `npm run test-polly` to create VO tracks in the examples folder that you can then use to try out `npm run test-rhubarb` and `npm run test-transcription`.

These examples are specified using a JSON definition in `./cheerfully.json` which you can copy or modify to set different generation parameters as supported by Cheerfully.
